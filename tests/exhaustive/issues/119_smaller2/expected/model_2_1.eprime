language ESSENCE' 1.0

find p_PartitionAsSet_ExplicitR3_Explicit: matrix indexed by [int(1..3), int(1)] of int(1..3)
find p_PartitionAsSet_ExplicitR2_Occurrence: matrix indexed by [int(1..3), int(1..3)] of bool
such that
    and([or([p_PartitionAsSet_ExplicitR3_Explicit[q47, 1] = 1 /\ 1 = p_PartitionAsSet_ExplicitR3_Explicit[q47, 1],
             p_PartitionAsSet_ExplicitR3_Explicit[q47, 1] = 2 /\ 2 = p_PartitionAsSet_ExplicitR3_Explicit[q47, 1],
             p_PartitionAsSet_ExplicitR3_Explicit[q47, 1] = 3 /\ 3 = p_PartitionAsSet_ExplicitR3_Explicit[q47, 1];
                 int(1..3)])
             | q47 : int(1..3)]),
    or([1 = p_PartitionAsSet_ExplicitR3_Explicit[q78, 1] /\ p_PartitionAsSet_ExplicitR3_Explicit[q78, 1] = 1
            | q78 : int(1..3)]),
    or([2 = p_PartitionAsSet_ExplicitR3_Explicit[q89, 1] /\ p_PartitionAsSet_ExplicitR3_Explicit[q89, 1] = 2
            | q89 : int(1..3)]),
    or([3 = p_PartitionAsSet_ExplicitR3_Explicit[q100, 1] /\ p_PartitionAsSet_ExplicitR3_Explicit[q100, 1] = 3
            | q100 : int(1..3)]),
    allDiff([p_PartitionAsSet_ExplicitR3_Explicit[q40, 1] | q40 : int(1..3)]),
    and([p_PartitionAsSet_ExplicitR3_Explicit[q4, ..] <lex p_PartitionAsSet_ExplicitR3_Explicit[q4 + 1, ..]
             | q4 : int(1..2)]),
    alldifferent_except([toInt(p_PartitionAsSet_ExplicitR2_Occurrence[q43, q11]) * catchUndef(q11, 0)
                             | q43 : int(1..3), q11 : int(1..3)],
                        0),
    and([p_PartitionAsSet_ExplicitR2_Occurrence[q13, ..] <lex p_PartitionAsSet_ExplicitR2_Occurrence[q13 + 1, ..]
             | q13 : int(1..2)]),
    and([1 = sum([toInt(p_PartitionAsSet_ExplicitR2_Occurrence[q14, q15]) | q15 : int(1..3)]) | q14 : int(1..3)]),
    and([or([p_PartitionAsSet_ExplicitR2_Occurrence[q20, p_PartitionAsSet_ExplicitR3_Explicit[q23, 1]] /\
             and([p_PartitionAsSet_ExplicitR2_Occurrence[q20, q26] -> p_PartitionAsSet_ExplicitR3_Explicit[q23, 1] = q26
                      | q26 : int(1..3)])
                 | q23 : int(1..3)])
             | q20 : int(1..3)]),
    and([or([and([p_PartitionAsSet_ExplicitR2_Occurrence[q34, q35] -> p_PartitionAsSet_ExplicitR3_Explicit[q31, 1] = q35
                      | q35 : int(1..3)])
             /\ p_PartitionAsSet_ExplicitR2_Occurrence[q34, p_PartitionAsSet_ExplicitR3_Explicit[q31, 1]]
                 | q34 : int(1..3)])
             | q31 : int(1..3)])

