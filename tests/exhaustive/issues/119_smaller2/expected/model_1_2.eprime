language ESSENCE' 1.0

find p_PartitionAsSet_ExplicitR2_Occurrence: matrix indexed by [int(1..3), int(1..3)] of bool
find p_PartitionAsSet_ExplicitR3_Explicit: matrix indexed by [int(1..3), int(1)] of int(1..3)
such that
    and([or([p_PartitionAsSet_ExplicitR2_Occurrence[q47, 1] /\
             and([p_PartitionAsSet_ExplicitR2_Occurrence[q47, q52] -> 1 = q52 | q52 : int(1..3)]),
             p_PartitionAsSet_ExplicitR2_Occurrence[q47, 2] /\
             and([p_PartitionAsSet_ExplicitR2_Occurrence[q47, q57] -> 2 = q57 | q57 : int(1..3)]),
             p_PartitionAsSet_ExplicitR2_Occurrence[q47, 3] /\
             and([p_PartitionAsSet_ExplicitR2_Occurrence[q47, q62] -> 3 = q62 | q62 : int(1..3)]);
                 int(1..3)])
             | q47 : int(1..3)]),
    or([and([p_PartitionAsSet_ExplicitR2_Occurrence[q69, q70] -> 1 = q70 | q70 : int(1..3)]) /\
        p_PartitionAsSet_ExplicitR2_Occurrence[q69, 1]
            | q69 : int(1..3)]),
    or([and([p_PartitionAsSet_ExplicitR2_Occurrence[q77, q78] -> 2 = q78 | q78 : int(1..3)]) /\
        p_PartitionAsSet_ExplicitR2_Occurrence[q77, 2]
            | q77 : int(1..3)]),
    or([and([p_PartitionAsSet_ExplicitR2_Occurrence[q85, q86] -> 3 = q86 | q86 : int(1..3)]) /\
        p_PartitionAsSet_ExplicitR2_Occurrence[q85, 3]
            | q85 : int(1..3)]),
    alldifferent_except([toInt(p_PartitionAsSet_ExplicitR2_Occurrence[q40, q2]) * catchUndef(q2, 0)
                             | q40 : int(1..3), q2 : int(1..3)],
                        0),
    and([p_PartitionAsSet_ExplicitR2_Occurrence[q4, ..] <lex p_PartitionAsSet_ExplicitR2_Occurrence[q4 + 1, ..]
             | q4 : int(1..2)]),
    and([1 = sum([toInt(p_PartitionAsSet_ExplicitR2_Occurrence[q5, q6]) | q6 : int(1..3)]) | q5 : int(1..3)]),
    allDiff([p_PartitionAsSet_ExplicitR3_Explicit[q42, 1] | q42 : int(1..3)]),
    and([p_PartitionAsSet_ExplicitR3_Explicit[q12, ..] <lex p_PartitionAsSet_ExplicitR3_Explicit[q12 + 1, ..]
             | q12 : int(1..2)]),
    and([or([and([p_PartitionAsSet_ExplicitR2_Occurrence[q23, q24] -> p_PartitionAsSet_ExplicitR3_Explicit[q20, 1] = q24
                      | q24 : int(1..3)])
             /\ p_PartitionAsSet_ExplicitR2_Occurrence[q23, p_PartitionAsSet_ExplicitR3_Explicit[q20, 1]]
                 | q23 : int(1..3)])
             | q20 : int(1..3)]),
    and([or([p_PartitionAsSet_ExplicitR2_Occurrence[q31, p_PartitionAsSet_ExplicitR3_Explicit[q34, 1]] /\
             and([p_PartitionAsSet_ExplicitR2_Occurrence[q31, q37] -> p_PartitionAsSet_ExplicitR3_Explicit[q34, 1] = q37
                      | q37 : int(1..3)])
                 | q34 : int(1..3)])
             | q31 : int(1..3)])

