language ESSENCE' 1.0

find p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Marker: int(0..3)
find p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence: matrix indexed by [int(1..3), int(1..3)] of bool
such that
    and([q17 <= p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Marker ->
         or([p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q17, 1] /\
             and([p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q17, q22] -> 1 = q22
                      | q22 : int(1..3)]),
             p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q17, 2] /\
             and([p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q17, q27] -> 2 = q27
                      | q27 : int(1..3)]),
             p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q17, 3] /\
             and([p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q17, q32] -> 3 = q32
                      | q32 : int(1..3)]);
                 int(1..3)])
             | q17 : int(1..3)]),
    or([q39 <= p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Marker /\
        (and([p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q39, q40] -> 1 = q40 | q40 : int(1..3)]) /\
         p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q39, 1])
            | q39 : int(1..3)]),
    or([q47 <= p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Marker /\
        (and([p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q47, q48] -> 2 = q48 | q48 : int(1..3)]) /\
         p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q47, 2])
            | q47 : int(1..3)]),
    or([q55 <= p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Marker /\
        (and([p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q55, q56] -> 3 = q56 | q56 : int(1..3)]) /\
         p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q55, 3])
            | q55 : int(1..3)]),
    alldifferent_except([toInt(q12 <= p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Marker /\
                               p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q12, q2])
                         * catchUndef(q2, 0)
                             | q12 : int(1..3), q2 : int(1..3)],
                        0),
    and([q13 <= p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Marker ->
         sum([toInt(p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q13, q14]) | q14 : int(1..3)]) >= 1
             | q13 : int(1..3)]),
    and([q4 + 1 <= p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Marker ->
         p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q4, ..] <lex
         p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q4 + 1, ..]
             | q4 : int(1..2)]),
    and([q5 > p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Marker ->
         and([p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q5, q9] = false | q9 : int(1..3)])
             | q5 : int(1..3)]),
    p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Marker <= 3,
    and([q6 <= p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Marker ->
         sum([toInt(p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q6, q7]) | q7 : int(1..3)]) <= 3
             | q6 : int(1..3)]),
    3 =
    sum([toInt(q10 <= p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Marker) *
         catchUndef(sum([toInt(p_PartitionAsSet_ExplicitVarSizeWithMarkerR2_Values_Occurrence[q10, q11])
                             | q11 : int(1..3)]),
                    0)
             | q10 : int(1..3)])

